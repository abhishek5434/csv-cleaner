<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Zeta Global CSV Cleaner</title>
  <style>
    :root {
      font-family: Arial, Helvetica, sans-serif;
      --zeta-blue: #0033a0;
      --zeta-gray: #f4f6f8;
    }
    body {
      background: var(--zeta-gray);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: start;
      padding: 20px;
      min-height: 100vh;
      margin: 0;
    }
    .container {
      background: white;
      padding: 2rem;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      width: 100%;
      max-width: 600px;
      text-align: center;
    }
    h2 {
      color: var(--zeta-blue);
      margin-top: 0;
    }
    p.description {
      color: #444;
      font-size: 1rem;
      line-height: 1.6;
      margin-bottom: 1.5rem;
    }
    .controls {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 0.5rem;
      align-items: center;
      margin-top: 1rem;
    }
    .controls input[type="file"] {
      cursor: pointer;
    }
    button {
      background-color: var(--zeta-blue);
      color: white;
      border: none;
      padding: 0.75rem 1.5rem;
      border-radius: 4px;
      cursor: pointer;
      font-size: 1rem;
      min-width: 140px;
    }
    button:hover:not(:disabled) {
      background-color: #002a85;
    }
    button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }
    footer {
      margin-top: 2rem;
      font-size: 0.9rem;
      color: #666;
      text-align: center;
    }

    /* Responsive tweaks */
    @media (max-width: 600px) {
      .container {
        padding: 1rem;
      }
      .controls {
        flex-direction: column;
      }
      button, .controls input[type="file"] {
        width: 100%;
        box-sizing: border-box;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <img 
      src="https://zetaglobal.com/wp-content/uploads/2023/02/zeta_logoPrimary.svg" 
      alt="Zeta Global Logo" 
      class="logo" 
      style="width:250px; margin-bottom:1rem;"
    />
    <h2>CSV Cleaner</h2>
    <p class="description">
      This tool is designed to help clean and standardize CSV files before using them in other systems.
      It removes unnecessary or unnamed columns, drops empty rows, and wraps every field in double quotes
      for maximum compatibility.<br><br>
      Simply choose your CSV file below, then click <strong>“Clean & Download”</strong> to get a cleaned version.
    </p>

    <div class="controls">
      <input type="file" id="csvFile" accept=".csv" />
      <button type="button" id="cleanBtn">Clean & Download</button>
      <button type="button" id="resetBtn">Reset</button>
    </div>
  </div>

  <!-- Libraries -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.2/papaparse.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>

  <!-- App Script -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const fileInput = document.getElementById('csvFile');
      const cleanBtn   = document.getElementById('cleanBtn');
      const resetBtn   = document.getElementById('resetBtn');
      const footer     = document.getElementById('footer');

      // Dynamic footer year
      footer.innerText = `© ${new Date().getFullYear()} Developed by Abhishek Raj, Sr BSA, Zeta Global`;

      // Toggle loading state
      function setLoading(isLoading) {
        cleanBtn.disabled = isLoading;
        cleanBtn.innerText = isLoading ? 'Processing…' : 'Clean & Download';
      }

      cleanBtn.addEventListener('click', () => {
        if (!fileInput.files.length) {
          alert('Please choose a CSV file first!');
          return;
        }
        setLoading(true);

        Papa.parse(fileInput.files[0], {
          header: true,
          skipEmptyLines: true,
          complete: results => {
            const { data, meta: { fields } } = results;
            const headers = fields.filter(h => h.trim() && !h.startsWith('Unnamed'));
            const cleaned = data.map(row => {
              const obj = {};
              headers.forEach(h => obj[h] = (row[h] || '').toString());
              return obj;
            });
            const csv = Papa.unparse(cleaned, {
              quotes: true,
              quoteChar: '"',
              header: true
            });
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8' });
            const baseName = fileInput.files[0].name.replace(/\.csv$/i, '');
            saveAs(blob, `${baseName}_output.csv`);
            setLoading(false);
          },
          error: err => {
            alert('Error parsing CSV: ' + err.message);
            setLoading(false);
          }
        });
      });

      resetBtn.addEventListener('click', () => {
        fileInput.value = '';
      });
    });
  </script>

  <footer id="footer"></footer>
</body>
</html>
